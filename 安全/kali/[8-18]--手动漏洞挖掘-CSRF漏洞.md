

# CSRF漏洞

* 简介
* 判断漏洞
* 服务器源码
    * dvwa Low 安全级别
    * dvwa Medium 安全级别
    * dvwa High 安全级别

## 简介

* 从信任角度
> XSS：利用用户对站点的信任，攻击者通过注入程序来修改网站来使用户浏览器被重定向等  
  CSRF：利用站带你对已经身份认证的用户的信任，攻击者伪造一个链接误导用户点击链接来使用用户的身份认证来访问服务器


* 结合社工在身份认证会话过程中实现供给
> 修改账号密码、个人信息（email、收货地址）  
  发送伪造的业务请求（网银、购物、投票）  
  关注他人社交账号、推送博文  
  在用户非自愿、不知情的情况下提交请求

* 业务逻辑漏洞
> 服务器对关键操作缺少确认机制  
  自动扫描程序无法发现此漏洞

* 漏洞利用条件
> 被害用户已经完成身份认证  
  新请求的提交不需要重新身份认证或确认机制  
  攻击者必须了解 Web APP 请求的参数构造  
  诱使用户触发攻击的指令（社工）  

* BurpSuite CSRF PoC gennretor
> POST / GET 方法

* 自动扫描程序的检测方法
> 在请求和响应过程中检查是否存在 anti-CSRF tokec 名  
  见擦汗服务器是否严恒 anti-CSRF token 的名值  
  检查 tiken 中可编辑的字符串   
  检查 referer 头是否可以伪造  

* 对策
> captcha  
  anti-CSRF token  
  referer 头  
  降低会话超时时间


